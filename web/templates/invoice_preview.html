<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.title}} - RentalCore</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" rel="stylesheet">
    <link href="/static/css/app.css" rel="stylesheet">
    <style>
        .preview-container {
            background: white;
            color: #000;
            padding: 30px;
            margin: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            font-family: Arial, sans-serif;
        }
        
        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 20px;
        }
        
        .company-info {
            text-align: right;
        }
        
        .invoice-title {
            font-size: 28px;
            color: #007bff;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .customer-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #007bff;
        }
        
        .invoice-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .details-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            width: 48%;
        }
        
        .line-items {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .line-items th {
            background: #007bff;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 500;
        }
        
        .line-items td {
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .line-items tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .totals {
            text-align: right;
            margin-bottom: 30px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .total-final {
            font-size: 18px;
            font-weight: bold;
            border-top: 2px solid #007bff;
            padding-top: 8px;
            color: #007bff;
        }
        
        .preview-notice {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ffeaa7;
            margin-bottom: 20px;
            text-align: center;
        }
        
        @media print {
            .preview-notice {
                display: none;
            }
            body {
                background: white !important;
            }
        }
    </style>
</head>
<body>
    <div class="preview-notice">
        <i class="bi bi-info-circle"></i> 
        <strong>Preview Mode</strong> - This is a preview of how your invoice will look. Sample line items are shown for demonstration.
    </div>

    <div class="preview-container">
        <!-- Invoice Header -->
        <div class="invoice-header">
            <div>
                <div style="width: 60px; height: 60px; background: #007bff; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 20px;">LOGO</div>
            </div>
            <div class="company-info">
                <div style="font-weight: bold; font-size: 18px; color: #007bff;">{{.company.CompanyName}}</div>
                {{if .company.AddressLine1}}<div>{{.company.AddressLine1}}</div>{{end}}
                {{if .company.AddressLine2}}<div>{{.company.AddressLine2}}</div>{{end}}
                <div>{{if .company.PostalCode}}{{.company.PostalCode}} {{end}}{{if .company.City}}{{.company.City}}{{end}}</div>
                <div>{{if .company.Phone}}{{.company.Phone}}{{end}}{{if and .company.Phone .company.Email}} | {{end}}{{if .company.Email}}{{.company.Email}}{{end}}</div>
            </div>
        </div>

        <!-- Invoice Title -->
        <div class="invoice-title">INVOICE</div>

        <!-- Customer Information -->
        <div class="customer-info">
            <div style="color: #007bff; font-weight: bold; margin-bottom: 10px;">Bill To:</div>
            <div style="font-weight: bold;">
                {{if .invoice.Customer.CompanyName}}
                    {{.invoice.Customer.CompanyName}}
                {{else}}
                    {{.invoice.Customer.FirstName}} {{.invoice.Customer.LastName}}
                {{end}}
            </div>
            {{if .invoice.Customer.AddressLine1}}
            <div>{{.invoice.Customer.AddressLine1}}</div>
            {{end}}
            {{if .invoice.Customer.AddressLine2}}
            <div>{{.invoice.Customer.AddressLine2}}</div>
            {{end}}
            {{if or .invoice.Customer.PostalCode .invoice.Customer.City}}
            <div>{{if .invoice.Customer.PostalCode}}{{.invoice.Customer.PostalCode}} {{end}}{{if .invoice.Customer.City}}{{.invoice.Customer.City}}{{end}}</div>
            {{end}}
        </div>

        <!-- Invoice Details -->
        <div class="invoice-details">
            <div class="details-box">
                <div style="margin-bottom: 8px;"><strong>Invoice #:</strong> {{.invoice.InvoiceNumber}}</div>
                <div style="margin-bottom: 8px;"><strong>Date:</strong> {{.invoice.IssueDate.Format "2006-01-02"}}</div>
                <div><strong>Due Date:</strong> {{.invoice.DueDate.Format "2006-01-02"}}</div>
                {{if .invoice.Job}}
                <div style="margin-top: 8px;"><strong>Job:</strong> {{.invoice.Job.Description}}</div>
                {{end}}
            </div>
            <div class="details-box" style="text-align: center; display: flex; flex-direction: column; justify-content: center;">
                <div style="font-size: 14px; margin-bottom: 5px; color: #666;">Amount Due</div>
                <div style="font-size: 24px; font-weight: bold; color: #007bff;">€{{printf "%.2f" .invoice.TotalAmount}}</div>
            </div>
        </div>

        <!-- Line Items -->
        <table class="line-items">
            <thead>
                <tr>
                    <th>Description</th>
                    <th style="text-align: center;">Quantity</th>
                    <th style="text-align: right;">Unit Price</th>
                    <th style="text-align: right;">Total</th>
                </tr>
            </thead>
            <tbody>
                {{range .invoice.LineItems}}
                <tr>
                    <td>{{.Description}}</td>
                    <td style="text-align: center;">{{.Quantity}}</td>
                    <td style="text-align: right;">€{{printf "%.2f" .UnitPrice}}</td>
                    <td style="text-align: right; font-weight: bold;">€{{printf "%.2f" .TotalPrice}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>

        <!-- Totals -->
        <div class="totals">
            <div style="display: inline-block; text-align: left;">
                <div class="total-row">
                    <span>Subtotal:</span>
                    <span style="margin-left: 50px;">€{{printf "%.2f" .invoice.Subtotal}}</span>
                </div>
                <div class="total-row">
                    <span>Tax (19%):</span>
                    <span style="margin-left: 50px;">€{{printf "%.2f" .invoice.TaxAmount}}</span>
                </div>
                <div class="total-row total-final">
                    <span>Total:</span>
                    <span style="margin-left: 50px;">€{{printf "%.2f" .invoice.TotalAmount}}</span>
                </div>
            </div>
        </div>

        <!-- Notes -->
        {{if .invoice.Notes}}
        <div style="margin-top: 30px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
            <div style="font-weight: bold; margin-bottom: 10px;">Notes:</div>
            <div>{{.invoice.Notes}}</div>
        </div>
        {{end}}

        <!-- Footer -->
        <div style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 10px; color: #666;">
            <div>Thank you for your business!</div>
            <div style="margin-top: 10px;">Payment Terms: Net 14 days</div>
        </div>
    </div>

    <script>
        // Auto-focus window for better UX
        window.focus();
        
        // Optional: Auto-print functionality
        function printInvoice() {
            window.print();
        }
    </script>
</body>
</html>